This folder contains the scripts used in this paper to identify candidate genes using regioneR.
# Overview
The analysis tests whether trait-associated SNPs are non-randomly enriched within gene-associated genomic regions.
For each trait, a single LD-pruned SNP set is evaluated against multiple gene region definitions (gene body only and gene body with upstream/downstream extensions). Statistical significance is assessed using permutation testing with chromosome-wise circular randomization.
The workflow is designed to be exploratory and hypothesis-agnostic, relying only on genomic coordinates rather than GWAS effect sizes or model-dependent statistics.

# Main analysis steps
## Input preparation
* Trait-specific SNP lists are obtained from the GWAS Catalog.
* SNP genomic positions and alleles are resolved using the 1000 Genomes Project Phase 3 autosomal VCF.
* LD pruning is applied using PLINK2 to retain approximately independent SNPs.
## Gene region definition
* Gene body regions are derived from GENCODE protein-coding genes.
* Extended gene regions are generated by expanding gene bodies upstream and downstream using multiple predefined window sizes.
## Gene-based enrichment analysis
* SNPs are tested for overlap with gene regions using regioneR.
* Enrichment is evaluated separately for:
  * SNPs overlapping gene bodies
  * SNPs located in flanking regions outside gene bodies
*Statistical significance is assessed by permutation testing.


## Software environment

All R-based analyses (regioneR enrichment tests and regioneReloaded local Z score profiling) were run under the following environment:
- R: 4.5.1 (2025-06-13) ["Great Square Root"]
- Platform: aarch64-apple-darwin20 (Apple Silicon)
- Bioconductor: 3.21.1
- Key packages:
  - regioneR: 1.40.1
  - regioneReloaded: 1.10.0
  - BSgenome.Hsapiens.UCSC.hg19.masked: 1.3.993
  - GenomicRanges: 1.60.0
  - IRanges: 2.42.0
For full package versions, see the session log generated by `sessionInfo()` (recommended to be saved as `sessionInfo.txt`).
